function errorCallback(e){return function(t){console.log(t),e.status(500),e.send("ERROR!")}}const express=require("express"),bodyParser=require("body-parser"),pg=require("pg"),app=express();app.use(express.static("public")),app.use(bodyParser.json());var pool=new pg.Pool({user:"postgres",password:"quentin",host:"localhost",port:5432,database:"nicole",ssl:!1});app.post("/events",function(e,t){var n=e.body,o="INSERT INTO events(eventname, eventdate, description, lat, lng) VALUES ($1::text, $2::date, $3::text, $4::decimal, $5::decimal)",s=[n.eventName,n.date,n.description,n.lat,n.lng];pool.query("INSERT INTO events(eventname, eventdate, description, lat, lng) VALUES ($1::text, $2::date, $3::text, $4::decimal, $5::decimal)",s).then(function(){t.status(201),t.send("INSERTED")}).catch(errorCallback(t))}),app.get("/events",function(e,t){pool.query("SELECT * FROM events ORDER BY eventdate ASC").then(function(e){t.send(e.rows)}).catch(function(e){console.log(e)})}),app.get("/recent",function(e,t){pool.query("SELECT * FROM events where eventdate - INTERVAL '24 HOUR' > now() ORDER BY eventdate ASC LIMIT 3").then(function(e){t.send(e.rows)}).catch(function(e){console.log(e)})}),app.get("/viewevent",function(e,t){var n=e.query.id;n=Number(n);var o=[n],s="select * from events where id = $1::int";pool.query("select * from events where id = $1::int",o).then(function(e){t.send(e.rows)}).catch(function(e){console.log(e)})});var port=process.env.PORT||5e3;app.listen(port,function(){console.log("JSON Server is running on "+port)});